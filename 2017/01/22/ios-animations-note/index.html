<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>iOS 动画笔记 | 萤火之森</title><meta name="keywords" content="Swift,iOS,动画"><meta name="author" content="猫冬"><meta name="copyright" content="猫冬"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="大坑未填完，发布下博文降低罪恶感…  人生的意义就是不断地挖坑，并不断地去填补。 ——猫冬  本文为《iOS Animations by Tutorials》笔记上篇，代码用 swift 3 编写。">
<meta property="og:type" content="article">
<meta property="og:title" content="iOS 动画笔记">
<meta property="og:url" content="http://frankorz.com/2017/01/22/ios-animations-note/index.html">
<meta property="og:site_name" content="萤火之森">
<meta property="og:description" content="大坑未填完，发布下博文降低罪恶感…  人生的意义就是不断地挖坑，并不断地去填补。 ——猫冬  本文为《iOS Animations by Tutorials》笔记上篇，代码用 swift 3 编写。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsdefault-cover.jpg">
<meta property="article:published_time" content="2017-01-22T14:30:10.000Z">
<meta property="article:modified_time" content="2022-07-05T08:45:39.249Z">
<meta property="article:author" content="猫冬">
<meta property="article:tag" content="Swift">
<meta property="article:tag" content="iOS">
<meta property="article:tag" content="动画">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsdefault-cover.jpg"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsfavicon.png"><link rel="canonical" href="http://frankorz.com/2017/01/22/ios-animations-note/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?91a6af339098c7b3314fd48d6640bbf8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-69634396-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-69634396-1');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'iOS 动画笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-07-05 08:45:39'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="萤火之森" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgshead.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">43</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://notes.frankorz.com"><i class="fa-fw far fa-sticky-note"></i><span> 公开笔记</span></a></div><div class="menus_item"><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书籍</span></a></div><div class="menus_item"><a class="site-page" href="/pixel-art/"><i class="fa-fw fas fa-palette"></i><span> 像素画</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsdefault-cover.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">萤火之森</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://notes.frankorz.com"><i class="fa-fw far fa-sticky-note"></i><span> 公开笔记</span></a></div><div class="menus_item"><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书籍</span></a></div><div class="menus_item"><a class="site-page" href="/pixel-art/"><i class="fa-fw fas fa-palette"></i><span> 像素画</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">iOS 动画笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2017-01-22T14:30:10.000Z" title="发表于 2017-01-22 14:30:10">2017-01-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-05T08:45:39.249Z" title="更新于 2022-07-05 08:45:39">2022-07-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/iOS%E5%9F%BA%E7%A1%80/">iOS基础</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>6分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="iOS 动画笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><em>大坑未填完，发布下博文降低罪恶感…</em></p>
<blockquote>
<p>人生的意义就是不断地挖坑，并不断地去填补。<br>
——猫冬</p>
</blockquote>
<p>本文为《iOS Animations by Tutorials》笔记上篇，代码用 swift 3 编写。</p>
<span id="more"></span>
<h2 id="动画属性">动画属性</h2>
<h3 id="简单的动画">简单的动画</h3>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@IBOutlet</span> <span class="keyword">var</span> heading: <span class="type">UILabel</span>!</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidAppear</span>(<span class="keyword">_</span> <span class="params">animated</span>: <span class="type">Bool</span>) &#123;</span><br><span class="line">  <span class="keyword">super</span>.viewDidAppear(animated)</span><br><span class="line">      <span class="type">UIView</span>.animate(withDuration: <span class="number">0.5</span>, delay: <span class="number">0.3</span>, options: [], animations: &#123;</span><br><span class="line">    <span class="comment">// 动画后位置 </span></span><br><span class="line">    <span class="keyword">self</span>.heading.center.x <span class="operator">+=</span> <span class="keyword">self</span>.view.bounds.width</span><br><span class="line">  &#125;, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewWillAppear</span>(<span class="keyword">_</span> <span class="params">animated</span>: <span class="type">Bool</span>) &#123;</span><br><span class="line">  <span class="keyword">super</span>.viewWillAppear(animated)</span><br><span class="line">  <span class="comment">// 动画前位置</span></span><br><span class="line">  heading.center.x <span class="operator">-=</span> view.bounds.width</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面这段代码的作用是把在屏幕左边的标题通过动画移动到相应位置。</p>
<p><img src="http://img.frankorz.com/58861fddb3f39.jpg" alt=""></p>
<p>这里使用了动画方法：<code>animate(withDuration:delay:usingSpringWithDamping:initialSpringVelocity:options:animations:completion:)</code></p>
<ul>
<li>withDuration: 动画持续时间。</li>
<li>delay: 动画开始前的延迟时间，值为0时动画效果立刻显示。</li>
<li>options: 表现动画的一系列方式，如淡入淡出等，可以直接用[]表示无动画选项。</li>
<li>animations: 代码块中提供你的动画效果，注意代码块中无参数和返回值。</li>
<li>completion: 动画执行后要干什么。</li>
</ul>
<h3 id="位置和大小">位置和大小</h3>
<p><img src="http://img.frankorz.com/58861fddc0e47.jpg" alt=""></p>
<p>我们可以通过改变一个 view 的位置和 frame 来实现放大、收缩或者移动效果。</p>
<ul>
<li><strong>frame</strong>: 该 view 在父view坐标系统中的位置和大小。</li>
<li><strong>bounds</strong>: 该 view 在本地坐标系统中的位置和大小。</li>
<li><strong>center</strong>: 想要移动 view 到一个新位置时改变该属性。</li>
</ul>
<p><img src="http://img.frankorz.com/58861fddc1903.jpg" alt=""></p>
<p>关于frame 和 bounds 的更详细的区别可以参考<a target="_blank" rel="noopener" href="http://blog.csdn.net/mad1989/article/details/8711697">ios view的frame和bounds之区别（位置和大小）</a>。</p>
<h3 id="外观">外观</h3>
<p><img src="http://img.frankorz.com/58861fddc6124.jpg" alt=""></p>
<p>我们可以通过改变背景色或透明度来改变 view 的外观。</p>
<ul>
<li><strong>backgroundColor</strong>: 改变背景颜色</li>
<li><strong>alpha</strong>: 改变该属性来创造淡入淡出效果</li>
</ul>
<h3 id="形变">形变</h3>
<p><img src="http://img.frankorz.com/58861fddbab3c.jpg" alt=""></p>
<ul>
<li><strong>transform</strong>: 在动画块中改变该属性可以去使 view 旋转、改变 view 大小或位置。</li>
</ul>
<h2 id="动画选项">动画选项</h2>
<p>options 能让你知道 UIKit 是怎么创建我们的动画的，下面是一系列声明在 UIViewAnimationOptions 集中的动画选项，可以以不同形式来结合，并在我们的动画中使用。</p>
<h3 id="重复">重复</h3>
<ul>
<li>.repeat: 这选项能让你的动画循环起来。</li>
<li>.autoreverse: 这选项只能和 <code>.repeat</code> 放在一起使用，作用是重复播放动画，然后逆向播放动画。</li>
</ul>
<p><img src="http://img.frankorz.com/58861fddb971c.gif" alt="repeat and .autoreverse"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UIView</span>.animate(withDuration: <span class="number">0.5</span>, delay: <span class="number">0.4</span>,</span><br><span class="line">               options: [.repeat, .autoreverse], animations: &#123;</span><br><span class="line">  <span class="keyword">self</span>.password.center.x <span class="operator">+=</span> <span class="keyword">self</span>.view.bounds.width</span><br><span class="line">&#125;, completion: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>
<h3 id="动画缓动">动画缓动</h3>
<p><img src="http://img.frankorz.com/58861fde014a0.jpg" alt=""></p>
<p>就像火车出站的时候会加速，到站时会减速一样，我们也可以给动画加上缓入缓出效果。</p>
<ul>
<li>.curveLinear: 没有加速也没有减速。</li>
<li>.curveEaseIn: 在动画开始时加速。</li>
<li>.curveEaseOut: 在动画结束时减速。</li>
<li>.curveEaseInOut: 动画开始时加速，结束时减速。</li>
</ul>
<p><img src="http://img.frankorz.com/58861fe7dfc4a.gif" alt=".curveEaseInOut"></p>
<h2 id="弹性">弹性</h2>
<p><img src="http://img.frankorz.com/58861fde2ce7d.jpg" alt=""></p>
<p><img src="http://img.frankorz.com/58861fde788e9.jpg" alt=""></p>
<p>像弹簧一样，动画也能实现这种来回弹动，最终停止在 point B 的效果。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewWillAppear</span>(<span class="keyword">_</span> <span class="params">animated</span>: <span class="type">Bool</span>) &#123;</span><br><span class="line">  <span class="keyword">super</span>.viewWillAppear(animated)</span><br><span class="line"> </span><br><span class="line">  loginButton.center.y <span class="operator">+=</span> <span class="number">30.0</span></span><br><span class="line">  loginButton.alpha <span class="operator">=</span> <span class="number">0.0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidAppear</span>(<span class="keyword">_</span> <span class="params">animated</span>: <span class="type">Bool</span>) &#123;</span><br><span class="line">  <span class="keyword">super</span>.viewDidAppear(animated)</span><br><span class="line"></span><br><span class="line">  <span class="type">UIView</span>.animate(withDuration: <span class="number">0.5</span>, delay: <span class="number">0.5</span>, usingSpringWithDamping: <span class="number">0.5</span>, </span><br><span class="line">    initialSpringVelocity: <span class="number">0.0</span>, options: [], animations: &#123; </span><br><span class="line">    <span class="keyword">self</span>.loginButton.center.y <span class="operator">-=</span> <span class="number">30.0</span></span><br><span class="line">    <span class="keyword">self</span>.loginButton.alpha <span class="operator">=</span> <span class="number">1.0</span></span><br><span class="line">  &#125;, completion: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://img.frankorz.com/58861fe869a3a.gif" alt="spring"></p>
<p>这里用了新的动画方法：<code>animate(withDuration:delay:usingSpringWithDamping:initialSpringVelocity:options:animations:completion:)</code></p>
<ul>
<li>usingSpringWithDamping: 控制阻尼系数，接受值在0.0和1.0之间，靠近0.0能创建一个有弹性的动画，靠近1.0能创建一个僵硬的效果。</li>
<li>initialSpringVelocity: 控制动画的速率，表示在一秒中动画所走的距离占总距离的比率。例如，动画中的距离为200 points，我们想达到100 pt/s的速度，则用0.5做值。数值越大移动越快。</li>
</ul>
<h2 id="过渡">过渡</h2>
<p>当你想通过动画来增加一个 view 或移除一个 view 的时候，你仍然可以使用前面提到的方法，这里将会告诉你如何使用过渡（transitions）来动画显示 view 中一系列的改变。</p>
<p>Transitions are predefined animations you can apply to views. These predefined animations don’t attempt to interpolate between the start and end states of your view. Instead, you’ll design the animations so that the various changes in state appear natural.</p>
<h3 id="增加一个-view">增加一个 view</h3>
<p><img src="http://img.frankorz.com/58861fdf00ba2.jpg" alt=""></p>
<p>和前面一样，我们也是调用类似的方法，不同的是这次将会选择一个预先定义好的过渡效果并在 <strong>animation container view</strong> 中显示动画。</p>
<p>过渡通过 container view 来显示，在动画播放的时候其他新的 view 将会作为子view加入其中。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> animationContainerView: <span class="type">UIView</span>!</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidLoad</span>() &#123; </span><br><span class="line">  <span class="comment">//创建 animation container </span></span><br><span class="line">  animationContainerView <span class="operator">=</span> <span class="type">UIView</span>(frame: view.bounds)</span><br><span class="line">  animationContainerView.frame <span class="operator">=</span> view.bounds</span><br><span class="line">  view.addSubview(animationContainerView<span class="operator">!</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">override</span> <span class="keyword">func</span> <span class="title function_">viewDidAppear</span>(<span class="keyword">_</span> <span class="params">animated</span>: <span class="type">Bool</span>) &#123; </span><br><span class="line">  <span class="keyword">super</span>.viewDidAppear(animated)</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 创建新的 view </span></span><br><span class="line">  <span class="keyword">let</span> newView <span class="operator">=</span> <span class="type">UIImageView</span>(image: <span class="type">UIImage</span>(named: <span class="string">&quot;banner&quot;</span>)<span class="operator">!</span>)</span><br><span class="line">  newView.center <span class="operator">=</span> animationContainerView.center</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 通过过渡把新的 view 加入其中</span></span><br><span class="line">  <span class="type">UIView</span>.transition(with: animationContainerView, duration: <span class="number">0.33</span>,</span><br><span class="line">                    options: [.curveEaseOut, .transitionFlipFromBottom],</span><br><span class="line">                    animations: &#123;</span><br><span class="line">                      <span class="keyword">self</span>.animationContainerView.addSubview(newView)</span><br><span class="line">  &#125;, completion: <span class="literal">nil</span> )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的代码可以看到，过渡的方法比之前看过的方法多了一个参数「view」，就是指要把过渡效果加入其中的 container view。另外未见过的还有<code>.transitionFlipFromBottom</code>，这也是定义好的过渡选项，显示的是一个底部翻转的效果，下面还列出所有的过渡动画选项。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.transitionFlipFromLeft </span><br><span class="line">.transitionFlipFromRight </span><br><span class="line">.transitionCurlUp </span><br><span class="line">.transitionCurlDown </span><br><span class="line">.transitionCrossDissolve </span><br><span class="line">.transitionFlipFromTop </span><br><span class="line">.transitionFlipFromBottom</span><br></pre></td></tr></table></figure>
<h3 id="移除-view">移除 view</h3>
<p><img src="http://img.frankorz.com/58861fe7e37f4.jpg" alt=""></p>
<p>代码和增加 view 类似，不过这次调用的是<code>removeFromSuperview()</code>方法。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UIView</span>.transition(with: animationContainerView, duration: <span class="number">0.33</span>,</span><br><span class="line">                  options: [.curveEaseOut, .transitionFlipFromBottom],</span><br><span class="line">                  animations: &#123;</span><br><span class="line">                    <span class="keyword">self</span>.newView.removeFromSuperview()</span><br><span class="line">&#125;, completion: <span class="literal">nil</span> )</span><br></pre></td></tr></table></figure>
<h3 id="隐藏-显示-view">隐藏/显示 view</h3>
<p><img src="http://img.frankorz.com/58861fe7c75a2.jpg" alt=""></p>
<p>到目前，我们只知道过渡效果要区分 view 的层次，这也是为什么我们需要一个 container view 的原因。对于隐藏或显示一个 view 的时候，我们可以通过用要隐藏或显示的 view 来当做动画容器（animation container）。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过过渡隐藏 newView，</span></span><br><span class="line"><span class="type">UIView</span>.transition(with: <span class="keyword">self</span>.newView, duration: <span class="number">0.33</span>,</span><br><span class="line">                  options: [.curveEaseOut, .transitionFlipFromBottom],</span><br><span class="line">                  animations: &#123;</span><br><span class="line">                    <span class="keyword">self</span>.newView.isHidden <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">&#125;, completion: <span class="literal">nil</span> )</span><br></pre></td></tr></table></figure>
<h3 id="用一个-view-来取代另一个-view">用一个 view 来取代另一个 view</h3>
<p><img src="http://img.frankorz.com/58861fe7cf2bb.jpg" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从 oldView 变为 newView</span></span><br><span class="line"><span class="type">UIView</span>.transition(from: oldView, to: newView, duration: <span class="number">0.33</span>, </span><br><span class="line">  options: .transitionFlipFromTop, completion: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>
<h2 id="更酷的动画">更酷的动画</h2>
<ol>
<li><strong>Crossfade animation:</strong> 淡入淡出动画，把一张图片与另一张图片混合的动画效果。</li>
<li><strong>Cube transition animation:</strong> 立方体过渡动画，创建伪 3D 的过渡效果。</li>
<li><strong>Fade and bounce transition:</strong> 淡入淡出和反弹过渡，与简单动画的结合有一些不同。</li>
</ol>
<h3 id="Crossfade-animation">Crossfade animation</h3>
<p><img src="http://img.frankorz.com/58861fe7e4ebb.jpg" alt=""></p>
<p>如果需要把一张图片直接变成另外一张图片，之前的淡入淡出就不太好用了，因为能看到中间的淡入淡出效果。</p>
<hr>
<p>楼主的坑已经不想填了，看到这的朋友可以参考：<br>
<a target="_blank" rel="noopener" href="https://zsisme.gitbooks.io/ios-/content/">iOS 核心动画高级技巧</a> ：<a target="_blank" rel="noopener" href="http://www.amazon.com/iOS-Core-Animation-Advanced-Techniques-ebook/dp/B00EHJCORC/ref=sr_1_1?ie=UTF8&amp;qid=1423192842&amp;sr=8-1&amp;keywords=Core+Animation+Advanced+Techniques">iOS Core Animation: Advanced Techniques</a> 的译本，由 OC 编写</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://frankorz.com/about/">猫冬</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://frankorz.com/2017/01/22/ios-animations-note/">http://frankorz.com/2017/01/22/ios-animations-note/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://frankorz.com" target="_blank">萤火之森</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Swift/">Swift</a><a class="post-meta__tags" href="/tags/iOS/">iOS</a><a class="post-meta__tags" href="/tags/%E5%8A%A8%E7%94%BB/">动画</a></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-57e27fcf6e91c81d" async="async"></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgswechat-reward.png" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgswechat-reward.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsalipay-reward.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsalipay-reward.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2017/02/16/mongodb_operate_in_irb/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsdefault-cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">IRB 中操作 MongoDB</div></div></a></div><div class="next-post pull-right"><a href="/2017/01/16/core-data-note-1/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsdefault-cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Core Data 笔记[上篇]</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2016/09/24/iOS-learning-source/" title="iOS学习资源集合"><img class="cover" src="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsdefault-cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-09-24</div><div class="title">iOS学习资源集合</div></div></a></div><div><a href="/2016/10/17/powerful-jsonexport/" title="用JSONExport一键生成JSON Model"><img class="cover" src="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsdefault-cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-10-17</div><div class="title">用JSONExport一键生成JSON Model</div></div></a></div><div><a href="/2017/01/16/core-data-note-1/" title="Core Data 笔记[上篇]"><img class="cover" src="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsdefault-cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2017-01-16</div><div class="title">Core Data 笔记[上篇]</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="disqusjs"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgshead.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">猫冬</div><div class="author-info__description">各种知识火种~</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">43</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">32</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Latias94"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Latias94" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:superfrankie621@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="http://weibo.com/u/1825527674" target="_blank" title="Weibo"><i class="fab fa-weibo"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到萤火之森🐈</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E7%94%BB%E5%B1%9E%E6%80%A7"><span class="toc-number">1.</span> <span class="toc-text">动画属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E5%8A%A8%E7%94%BB"><span class="toc-number">1.1.</span> <span class="toc-text">简单的动画</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%8D%E7%BD%AE%E5%92%8C%E5%A4%A7%E5%B0%8F"><span class="toc-number">1.2.</span> <span class="toc-text">位置和大小</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E8%A7%82"><span class="toc-number">1.3.</span> <span class="toc-text">外观</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%A2%E5%8F%98"><span class="toc-number">1.4.</span> <span class="toc-text">形变</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E7%94%BB%E9%80%89%E9%A1%B9"><span class="toc-number">2.</span> <span class="toc-text">动画选项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%A4%8D"><span class="toc-number">2.1.</span> <span class="toc-text">重复</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E7%94%BB%E7%BC%93%E5%8A%A8"><span class="toc-number">2.2.</span> <span class="toc-text">动画缓动</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%B9%E6%80%A7"><span class="toc-number">3.</span> <span class="toc-text">弹性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%B8%A1"><span class="toc-number">4.</span> <span class="toc-text">过渡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A2%9E%E5%8A%A0%E4%B8%80%E4%B8%AA-view"><span class="toc-number">4.1.</span> <span class="toc-text">增加一个 view</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E9%99%A4-view"><span class="toc-number">4.2.</span> <span class="toc-text">移除 view</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%90%E8%97%8F-%E6%98%BE%E7%A4%BA-view"><span class="toc-number">4.3.</span> <span class="toc-text">隐藏&#x2F;显示 view</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E4%B8%80%E4%B8%AA-view-%E6%9D%A5%E5%8F%96%E4%BB%A3%E5%8F%A6%E4%B8%80%E4%B8%AA-view"><span class="toc-number">4.4.</span> <span class="toc-text">用一个 view 来取代另一个 view</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E9%85%B7%E7%9A%84%E5%8A%A8%E7%94%BB"><span class="toc-number">5.</span> <span class="toc-text">更酷的动画</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Crossfade-animation"><span class="toc-number">5.1.</span> <span class="toc-text">Crossfade animation</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/01/18/rust-study-resource/" title="Rust 学习资源"><img src="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsrust-study-resource-cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Rust 学习资源"/></a><div class="content"><a class="title" href="/2022/01/18/rust-study-resource/" title="Rust 学习资源">Rust 学习资源</a><time datetime="2022-01-18T14:01:44.000Z" title="发表于 2022-01-18 14:01:44">2022-01-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/05/rust-raytrace/" title="用 Rust 实现简单的光线追踪"><img src="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsrust-raytrace-cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="用 Rust 实现简单的光线追踪"/></a><div class="content"><a class="title" href="/2021/05/05/rust-raytrace/" title="用 Rust 实现简单的光线追踪">用 Rust 实现简单的光线追踪</a><time datetime="2021-05-05T00:48:30.000Z" title="发表于 2021-05-05 00:48:30">2021-05-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/18/learn-pixel-art/" title="24 天像素画从入门到放弃"><img src="http://img.frankorz.com/day23-dog-in-snow.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="24 天像素画从入门到放弃"/></a><div class="content"><a class="title" href="/2021/04/18/learn-pixel-art/" title="24 天像素画从入门到放弃">24 天像素画从入门到放弃</a><time datetime="2021-04-18T12:33:30.000Z" title="发表于 2021-04-18 12:33:30">2021-04-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/17/compute-shader/" title="Compute Shader 简介"><img src="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgscompute-shader-cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Compute Shader 简介"/></a><div class="content"><a class="title" href="/2021/04/17/compute-shader/" title="Compute Shader 简介">Compute Shader 简介</a><time datetime="2021-04-17T22:14:30.000Z" title="发表于 2021-04-17 22:14:30">2021-04-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/10/03/add-note-section-to-blog/" title="博客新增公开笔记部分"><img src="https://cdn.jsdelivr.net/gh/latias94/blog-images@main/top/frankorz/blog/imgsadd-note-section-to-blog-cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="博客新增公开笔记部分"/></a><div class="content"><a class="title" href="/2020/10/03/add-note-section-to-blog/" title="博客新增公开笔记部分">博客新增公开笔记部分</a><time datetime="2020-10-03T15:53:30.000Z" title="发表于 2020-10-03 15:53:30">2020-10-03</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 猫冬</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a href="beian.miit.gov.cn"><span>粤ICP备19098175号-1</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadDisqusjs () {
  function addDisqusjsCSS () {
    const ele = document.createElement('link')
    ele.rel = 'stylesheet'
    ele.href= 'https://cdn.jsdelivr.net/npm/disqusjs/dist/browser/styles/disqusjs.min.css'
    document.getElementsByTagName('head')[0].appendChild(ele)
  }

  function initDisqusjs () {
    window.disqusjs = null
    disqusjs = new DisqusJS(Object.assign({
      shortname: 'frankorz',
      identifier: '/2017/01/22/ios-animations-note/',
      url: 'http://frankorz.com/2017/01/22/ios-animations-note/',
      title: 'iOS 动画笔记',
      apikey: 'qwWAtej9akBTCAcHatuVvjvVxs9Help2KiXmb63FEdzQs61RZmFjkSWyhbqZEcto',
    },null))

    disqusjs.render(document.getElementById('disqusjs'))
  }

  const themeChange = () => {
    const ele = document.getElementById('disqus_thread')
    if(!ele) return
    disqusjs.destroy()
    initDisqusjs()
  }


  document.getElementById('darkmode').addEventListener('click', themeChange)

  if (window.disqusJsLoad) initDisqusjs()
  else {
    addDisqusjsCSS()
    getScript('https://cdn.jsdelivr.net/npm/disqusjs/dist/browser/disqusjs.es2015.umd.min.js').then(initDisqusjs)
    window.disqusJsLoad = true
  }
}

if ('Disqusjs' === 'Disqusjs' || !true) {
  if (true) btf.loadComment(document.getElementById('disqusjs'), loadDisqusjs)
  else loadDisqusjs()
}
else {
  function loadOtherComment () {
    loadDisqusjs()
  }
}

</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>